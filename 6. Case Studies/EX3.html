

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Frequencies of “has” and “hath” &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '6. Case Studies/EX3';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Documentation" href="../7.%20API%20Documentation/API%20Documentation.html" />
    <link rel="prev" title="The size of character parts from largest to smallest" href="EX2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Stylometric Intelligent Archive (SIA)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">1. Texts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1.%20Texts/Texts.html">Texts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">2. Concordance</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2.%20Concordance/Concordance.html">Concordance</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">3. Word Frequencies</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../3.%20Word%20Frequencies/Word%20Frequencies.html">Word Frequencies</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">4. Divergence</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../4.%20Divergence/Divergence.html">Divergence</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">5. Burrows Zeta</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../5.%20Burrows%20Zeta/Burrows%27%20Zeta.html">Burrows’ Zeta</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">6. Case Studies</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="EX1.html">Top 10 most frequent 6-grams</a></li>
<li class="toctree-l1"><a class="reference internal" href="EX2.html">The size of character parts from largest to smallest</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Frequencies of “has” and “hath”</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">7. API Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../7.%20API%20Documentation/API%20Documentation.html">API Documentation</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Systemik-Solutions/sia_site" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Systemik-Solutions/sia_site/issues/new?title=Issue%20on%20page%20%2F6. Case Studies/EX3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/6. Case Studies/EX3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Frequencies of “has” and “hath”</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="frequencies-of-has-and-hath">
<h1>Frequencies of “has” and “hath”<a class="headerlink" href="#frequencies-of-has-and-hath" title="Permalink to this heading">#</a></h1>
<p>This notebook demonstrates using the <ins>SIA API</ins> to analyse the usage of words “has” and “hath” in Shakespear plays over the years.</p>
<p><em>&#64;Hugh, some explaination about the purpose of doing this experiment</em></p>
<p>Firstly, a number of dependency modules are imported here.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">requests</span></code>: is used for sending requests to the SIA API.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code>: we use the Matplotlib to create the chart based on the results from the SIA API.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib.ticker</span></code>: is used for setting up the plot ticks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IPython.display</span></code>: is used for rendering the results from the SIA API as HTML tables.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">FixedLocator</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we set up the API endpoint here. In this example, we use the <ins>Word Frequencies API</ins>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request_url</span> <span class="o">=</span> <span class="s2">&quot;https://sia.ardc-hdcl-sia-iaw.cloud.edu.au/api/v1/word-frequencies&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>In order to use the API, an API key is requried to authenticate the requests. The API key must be specified in a custom HTTP header <code class="docutils literal notranslate"><span class="pre">X-API-KEY</span></code> and sent along with every request.</p>
<p>You should use your own API keys for your own notebooks and always keep your keys confidential. Read more about <ins>how to create API keys</ins> in SIA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">api_key</span> <span class="o">=</span> <span class="s2">&quot;255446bcdde7ca9fe776258d09e8411bbb8d1cade2ebd6aba440f80f6817c3fd&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Then, we start to prepare the request data which we can send to the Word Frequencies API. In this example, we are going to use a text set containing 20 Shakespear plays which has been already uploaded in the SIA platform. Instead of passing the actual text contents to the API, we can tell the API to use one of the texts or text sets from SIA by specifying its ID.</p>
<p>The URL of a text/text set page from <ins>SIA Application</ins> indicates the ID of that text/text set. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">sia</span><span class="o">.</span><span class="n">ardc</span><span class="o">-</span><span class="n">hdcl</span><span class="o">-</span><span class="n">sia</span><span class="o">-</span><span class="n">iaw</span><span class="o">.</span><span class="n">cloud</span><span class="o">.</span><span class="n">edu</span><span class="o">.</span><span class="n">au</span><span class="o">/</span><span class="n">text</span><span class="o">-</span><span class="n">sets</span><span class="o">/</span><span class="mi">86</span>
</pre></div>
</div>
<p>In this case, the ID of the “20 Shakespear plays” text set is <code class="docutils literal notranslate"><span class="pre">86</span></code>.</p>
<p>We will also pass serveral word frequecies options to the Word Frequencies API. These options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">blockMethod</span></code>: We set the block method to <code class="docutils literal notranslate"><span class="pre">0</span></code>(By text), which makes each text from the text set as a single segment.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">showMetadata</span></code>: These Shakespear plays from SIA contain associated metadata. We are going to use the <code class="docutils literal notranslate"><span class="pre">Date</span> <span class="pre">of</span> <span class="pre">first</span> <span class="pre">performance</span></code> metadata to dertermin the year of a play. Therefore, we set this option to <code class="docutils literal notranslate"><span class="pre">true</span></code> to ask the API to return the metadata of texts in addition.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputSpecialWords</span></code>: As we are only interested in the words “has” and “hath”, we tell the API to only return the frequencies of these two words.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputSpecialWordsOption</span></code>: We want to calculate the frequencies for all words but only ouput the frequencies of the words “has” and “hath”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">excludeWords</span></code>: We are excluding some common punctuation marks from our analysis.</p></li>
</ul>
<p>To view more details about options of Word Frequencies API, read the <ins>API documentation</ins>.</p>
<p><em>&#64;Hugh: more explainations about these options may be specified here</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;textSet&#39;</span><span class="p">:</span> <span class="mi">86</span><span class="p">,</span>
    <span class="s1">&#39;option&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;blockMethod&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>         <span class="c1">#Segment by text</span>
        <span class="s1">&#39;showMetadata&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;outputSpecialWords&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;has&quot;</span><span class="p">,</span><span class="s2">&quot;hath&quot;</span><span class="p">],</span>
        <span class="s1">&#39;outputSpecialWordsOption&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Only show the word frequencies of special words</span>
        <span class="s1">&#39;excludeWords&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;[&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;`&quot;</span><span class="p">,</span> <span class="s2">&quot;!&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;–&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;~&quot;</span><span class="p">,</span> <span class="s2">&quot;?&quot;</span> <span class="p">],</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>The SIA API accept JSON as the request data. Here we have constructed a Python dictionary object with the text set identifier and the word frequencies options. Next we are going to put all things together and use the <a class="reference external" href="https://requests.readthedocs.io/en/latest/">Requests</a> module to send the request to the SIA API.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make API request</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">request_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">request_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X-API-KEY&quot;</span><span class="p">:</span> <span class="n">api_key</span><span class="p">},</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1200</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We have specified the API endpoint, request data we defined earlier and the <code class="docutils literal notranslate"><span class="pre">X-API-KEY</span></code> HTTP header for the API request and received the response. Please note that the API call can take serveral minutes to finish based on the size of the text or text set. Therefore, we have set the request timeout to <code class="docutils literal notranslate"><span class="pre">1200</span></code> seconds.</p>
<p>Before we start unpacking the response data, we want to make sure the API call was successful by checking the HTTP response code. Read the <ins>API documentation</ins> for all error codes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
<span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>200 OK
</pre></div>
</div>
</div>
</div>
<p>Now, we have the response data ready from Word Frequencies API. We firstly want to have a glance of the proportions of words “has” and “hath” used in each year from a table. We are going to create the tabular data from response data. Read more about the <ins>response data</ins> of Word Frequencies API.</p>
<p>We will have two header rows for the table. The first header row will display the play names, and the second will list the years of the plays. Instead using the word frequency numbers, we will calculate the proportions of words and display them in each column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_headers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">table_rows</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">response_data</span><span class="p">[</span><span class="s1">&#39;blocks&#39;</span><span class="p">]:</span>
    <span class="c1"># Add block names as the first header row.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">table_headers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">table_headers</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;Word&#39;</span><span class="p">])</span>
    <span class="n">table_headers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

    <span class="c1"># Add the years as the second header row.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">table_headers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">table_headers</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">])</span>
    <span class="n">table_headers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;Date of first performance&#39;</span><span class="p">])</span>

    <span class="c1"># Add data rows.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s1">&#39;frequencies&#39;</span><span class="p">])):</span>
        <span class="n">frequency</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s1">&#39;frequencies&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="c1"># Check whether the row has been created. If not, initialise the row with the word text.</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">table_rows</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">table_rows</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">frequency</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">]])</span>
        <span class="c1"># Calculate the fequency proportion.</span>
        <span class="n">proportion</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">frequency</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">block</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span>
        <span class="c1"># Append the word frequency proportion to its corresponding row.</span>
        <span class="n">table_rows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proportion</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The next step is to generate the HTML markups based on the tabular data and render it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start with the opening tags of container and table elements.</span>
<span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;div style=&quot;overflow-x: auto; margin-top: 40px;&quot;&gt;&lt;table border=&quot;1&quot;&gt;&#39;</span>

<span class="c1"># Append table headers.</span>
<span class="k">for</span> <span class="n">table_row</span> <span class="ow">in</span> <span class="n">table_headers</span><span class="p">:</span>
    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span>
    <span class="k">for</span> <span class="n">table_cell</span> <span class="ow">in</span> <span class="n">table_row</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;&lt;th style=&quot;white-space: nowrap;&quot;&gt;</span><span class="si">{</span><span class="n">table_cell</span><span class="si">}</span><span class="s1">&lt;/td&gt;&#39;</span>
    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>

<span class="c1"># Append HTML for table rows.</span>
<span class="k">for</span> <span class="n">table_row</span> <span class="ow">in</span> <span class="n">table_rows</span><span class="p">:</span>
    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span>
    <span class="k">for</span> <span class="n">table_cell</span> <span class="ow">in</span> <span class="n">table_row</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;&lt;td&gt;</span><span class="si">{</span><span class="n">table_cell</span><span class="si">}</span><span class="s1">&lt;/td&gt;&#39;</span>
    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>

<span class="c1"># Close the table and container elements.</span>
<span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&lt;/div&gt;&#39;</span>

<span class="c1"># Render the HTML.</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div style="overflow-x: auto; margin-top: 40px;"><table border="1"><tr><th style="white-space: nowrap;">Word</td><th style="white-space: nowrap;">1 Henry IV Q1 (1)</td><th style="white-space: nowrap;">Antony and Cleopatra (1)</td><th style="white-space: nowrap;">Comedy of Errors (1)</td><th style="white-space: nowrap;">Coriolanus (1)</td><th style="white-space: nowrap;">Hamlet Q2 (1)</td><th style="white-space: nowrap;">Henry V F (1)</td><th style="white-space: nowrap;">Julius Caesar (1)</td><th style="white-space: nowrap;">King Lear Q1 (1)</td><th style="white-space: nowrap;">Love's Labor's Lost Q1 (1)</td><th style="white-space: nowrap;">Macbeth (1)</td><th style="white-space: nowrap;">Merchant of Venice Q1 (1)</td><th style="white-space: nowrap;">Midsummer Night's Dream Q1 (1)</td><th style="white-space: nowrap;">Much Ado About Nothing Q1 (1)</td><th style="white-space: nowrap;">Othello Q1 (1)</td><th style="white-space: nowrap;">Richard II Q1 (1)</td><th style="white-space: nowrap;">Richard III Q1 (1)</td><th style="white-space: nowrap;">Romeo and Juliet Q2 (1)</td><th style="white-space: nowrap;">Tempest (1)</td><th style="white-space: nowrap;">Twelfth Night (1)</td><th style="white-space: nowrap;">Winter's Tale (1)</td></tr><tr><th style="white-space: nowrap;">Year</td><th style="white-space: nowrap;">1597</td><th style="white-space: nowrap;">1606</td><th style="white-space: nowrap;">1592</td><th style="white-space: nowrap;">1608</td><th style="white-space: nowrap;">1600</td><th style="white-space: nowrap;">1599</td><th style="white-space: nowrap;">1599</td><th style="white-space: nowrap;">1605</td><th style="white-space: nowrap;">1595</td><th style="white-space: nowrap;">1606</td><th style="white-space: nowrap;">1596</td><th style="white-space: nowrap;">1595</td><th style="white-space: nowrap;">1598</td><th style="white-space: nowrap;">1604</td><th style="white-space: nowrap;">1595</td><th style="white-space: nowrap;">1593</td><th style="white-space: nowrap;">1595</td><th style="white-space: nowrap;">1611</td><th style="white-space: nowrap;">1601</td><th style="white-space: nowrap;">1611</td></tr><tr><td>hath</td><td>0.2059%</td><td>0.1726%</td><td>0.2299%</td><td>0.1826%</td><td>0.2186%</td><td>0.218%</td><td>0.1782%</td><td>0.2072%</td><td>0.1767%</td><td>0.3021%</td><td>0.2386%</td><td>0.2304%</td><td>0.3468%</td><td>0.1583%</td><td>0.32%</td><td>0.226%</td><td>0.349%</td><td>0.1556%</td><td>0.1748%</td><td>0.1675%</td></tr><tr><td>has</td><td>0.0081%</td><td>0.0883%</td><td>0.0%</td><td>0.1289%</td><td>0.0336%</td><td>0.0306%</td><td>0.0153%</td><td>0.0438%</td><td>0.0%</td><td>0.1104%</td><td>0.0094%</td><td>0.0%</td><td>0.0187%</td><td>0.1385%</td><td>0.0%</td><td>0.0%</td><td>0.0081%</td><td>0.0539%</td><td>0.0999%</td><td>0.1236%</td></tr></table></div></div></div>
</div>
<p><em>&#64;Hugh: more insights about the table can be described here</em></p>
<p>Next, we will plot the usage of words “has” and “hath” over the years in a line chart. We will firstly aggregate the word frequencies in each year. Each block from the response data will have the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> about the play. We will use the metadata <code class="docutils literal notranslate"><span class="pre">Date</span> <span class="pre">of</span> <span class="pre">first</span> <span class="pre">performance</span></code> to get the years of play.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_to_has_count</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">year_to_hath_count</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">year_to_word_count</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">response_data</span><span class="p">[</span><span class="s1">&#39;blocks&#39;</span><span class="p">]:</span>
    <span class="c1"># Get the year from metadata.</span>
    <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;Date of first performance&#39;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="s1">&#39;frequencies&#39;</span><span class="p">])):</span>
        <span class="n">frequency</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s1">&#39;frequencies&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">frequency</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;has&#39;</span><span class="p">:</span>
            <span class="c1"># Build up the count of word &#39;has&#39; of that year.</span>
            <span class="n">year_to_has_count</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">year_to_has_count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">frequency</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">frequency</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;hath&#39;</span><span class="p">:</span>
            <span class="c1"># Build up the count of word &#39;hath&#39; of that year.</span>
            <span class="n">year_to_hath_count</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">year_to_hath_count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">frequency</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="c1"># Build up the total word count of that year.</span>
        <span class="n">year_to_word_count</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">year_to_word_count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">block</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span>    
</pre></div>
</div>
</div>
</div>
<p>We have created three dictionaries:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">year_to_has_count</span></code>: contains the frequency of word “has” from each year.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">year_to_hath_count</span></code>: contains the frequency of word “hath” from each year.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">year_to_word_count</span></code>: contains the total number of words from each year.</p></li>
</ul>
<p>We then need to sort the years and calculate the proportions of words in each year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">years</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">year_to_word_count</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">has_proportions</span> <span class="o">=</span> <span class="p">[(</span><span class="n">year_to_has_count</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">/</span> <span class="n">year_to_word_count</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">year_to_has_count</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
<span class="n">hath_proportions</span> <span class="o">=</span> <span class="p">[(</span><span class="n">year_to_hath_count</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">/</span> <span class="n">year_to_word_count</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">year_to_hath_count</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
</pre></div>
</div>
</div>
</div>
<p>We have created three lists which we can use for the chart:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">years</span></code>: the list of years sorted from the earliest to the latest.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">has_proportions</span></code>: the proportions of word “has” in each year sorted by year.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hath_proportions</span></code>: the proportions of word “hath” in each year sorted by year.</p></li>
</ul>
<p>Now we will use the <a class="reference external" href="https://matplotlib.org/">Matplotlib</a> library to create a line chart from these.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">has_proportions</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HAS&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">hath_proportions</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HATH&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Percentage&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average percentages of HAS and HATH in Shakespeare plays, by year of first performance&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1590</span><span class="p">,</span> <span class="mi">1615</span><span class="p">)</span>
<span class="n">y_ticks</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fcab2678539cc74bd01a7e0c84270e62132b703d64557329effcf6f145c7111d.png" src="../_images/fcab2678539cc74bd01a7e0c84270e62132b703d64557329effcf6f145c7111d.png" />
</div>
</div>
<p><em>&#64;Hugh: some insights about the chart</em></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./6. Case Studies"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="EX2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The size of character parts from largest to smallest</p>
      </div>
    </a>
    <a class="right-next"
       href="../7.%20API%20Documentation/API%20Documentation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">API Documentation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>